<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Quicksand:wght@300..700&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="styles/header.css" />
    <link rel="stylesheet" href="styles/products.css" />
    <link rel="stylesheet" href="styles/card.css" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <nav class="nav">
      <div class="container">
        <div class="nav__content">
          <div class="nav__logo">
            <img src="/assets/shofi-logo.svg" alt="" />
          </div>
          <div class="nav__search-container">
            <input
              class="nav__search"
              type="text"
              placeholder="Search products"
            />
            <button class="nav__search-button">Search</button>
          </div>
          <div class="nav__links">Login</div>
        </div>
        <div class="nav__filters js-nav__filters"></div>
      </div>
    </nav>

    <main class="page">
      <div class="container">
        <section class="page__products js-page__products">
          <!-- <div class="product__card">
            <div class="product__card-content">
              <div class="product__card-image">
                <img src="/assets/images/psp-poduct.png" alt="" />
              </div>
              <div class="product__card-details">
                <p class="product__card-title">ORIGINAL PSP 3000 SLIM...</p>
                <p class="product__card-price">â‚±5,800.00</p>
              </div>
            </div>
          </div> -->
        </section>
      </div>
    </main>

    <script>
      const url = "https://fakestoreapi.com/products";

      let allProducts = [];

      async function getProducts() {
        const response = await fetch(url);
        if (!response.ok)
          throw new Error(`HTTP error! Status ${response.status}`);
        return response.json();
      }

      function renderProducts(products) {
        const productGrid = document.querySelector(".js-page__products");
        const productFilters = document.querySelector(".js-nav__filters");
        let htmlFilters = "";
        let htmlProducts = "";

        const catObj = {};

        for (let categories of products) {
          if (!catObj[categories.category]) {
            htmlFilters += `<button class="js-nav__category">${categories.category}</button>`;
          }

          catObj[categories.category] = (catObj[categories.category] || 0) + 1;
        }

        products.forEach((product) => {
          htmlProducts += `
           <div class="product__card">
             <div class="product__card-content">
               <div class="product__card-image">
                 <img src="${product.image}" alt="" />
               </div>
               <div class="product__card-details">
                 <p class="product__card-title">${product.title}</p>
                 <p class="product__card-price">$${product.price}</p>
                 <div class="product__card-rating">
                   <img src="/assets/star.svg" />
                   <p>${product.rating.rate}</p>
                   <p>(${product.rating.count})</p>
                 </div>
               </div>
             </div>
           </div>
           `;
        });

        productFilters.innerHTML = htmlFilters;
        productGrid.innerHTML = htmlProducts;
      }

      async function initProducts() {
        const products = await getProducts();
        allProducts = products;
        renderProducts(allProducts);
      }

      initProducts();
    </script>
  </body>
</html>
